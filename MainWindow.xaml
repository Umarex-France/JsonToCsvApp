<Window x:Class="JsonToCsvApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="JSON2EXCEL"
        Height="700" Width="900" MinWidth="900" MinHeight="700"
        Background="#CC0000" Foreground="White" FontFamily="Segoe UI"
        Padding="100">

    <Window.Resources>
        <!-- TextBox arrondie (pilule) -->
        <Style x:Key="RoundedTextBoxStyle" TargetType="TextBox">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border CornerRadius="16" BorderBrush="White" BorderThickness="1" Background="Transparent">
                            <ScrollViewer x:Name="PART_ContentHost" Margin="10,2"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- PasswordBox arrondie (pilule) -->
        <Style x:Key="RoundedPasswordBoxStyle" TargetType="PasswordBox">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="PasswordBox">
                        <Border CornerRadius="16" BorderBrush="White" BorderThickness="1" Background="Transparent">
                            <ScrollViewer x:Name="PART_ContentHost" Margin="10,2"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Style global pour Button (pilule) -->
        <Style TargetType="Button">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="#CC0000"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="6,3"/>
            <Setter Property="Margin" Value="4"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Width" Value="100"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="16">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#F0F0F0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Style global pour CheckBox -->
        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="White"/>
        </Style>
    </Window.Resources>

    <Grid Margin="25">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="20"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="20"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- HEADER -->
        <Grid Grid.Row="0" Margin="0,0,0,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

             <Image Source="pack://application:,,,/Resources/umarexLogo.png"
                   Height="60" VerticalAlignment="Center"
                   Margin="0,0,0,0"/>
            <TextBlock Grid.Column="1" Text="JSON2EXCEL"
                       FontSize="26" FontWeight="Bold"
                       Foreground="White"
                       VerticalAlignment="Center"
                       HorizontalAlignment="Right"/>
        </Grid>

        <!-- SECTION 1 : R√âCUP√âRATION DES DONN√âES -->
        <TextBlock Grid.Row="2" Text="R√âCUP√âRATION DES DONN√âES"
                   FontSize="20" FontWeight="Bold"
                   Margin="0,0,0,10"/>
        <Grid Grid.Row="3" Margin="12,0,12,12">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="8"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="12"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="12"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Row="0" Grid.Column="0" Text="Endpoint (URL) :" VerticalAlignment="Center" FontSize="10"/>
            <TextBox x:Name="EndpointTextBox" Grid.Row="0" Grid.Column="2" Style="{StaticResource RoundedTextBoxStyle}"
                     Text="https://b2b.umarex.fr/api/v1/article-b2c" FontSize="16"/>
            <Button x:Name="SaveApiButton" Grid.Row="0" Grid.Column="3" Content="SAUVER" Width="90" Click="SaveApiButton_Click"/>

            <TextBlock Grid.Row="2" Grid.Column="0" Text="API Key :" VerticalAlignment="Center"/>
            <Grid Grid.Row="2" Grid.Column="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="0"/>
                </Grid.ColumnDefinitions>
                <PasswordBox x:Name="ApiKeyBox" Grid.Column="0" Style="{StaticResource RoundedPasswordBoxStyle}"/>
                <TextBox x:Name="ApiKeyPlainTextBox" Grid.Column="0" Visibility="Collapsed" Style="{StaticResource RoundedTextBoxStyle}"
                    Text="BJtUREfRI6mXtTFh1n7tUa9pnr57DkG_IAZa8eSAr70" FontSize="16"/>
                <ToggleButton x:Name="ApiRevealToggle" Grid.Column="1" Width="32" Height="28" Margin="6,0,0,0">üëÅ</ToggleButton>
            </Grid>

            
        </Grid>

        <!-- SECTION 2 : CHOIX DU DOSSIER -->
        <TextBlock Grid.Row="5" Text="CHOIX DU DOSSIER"
                   FontSize="20" FontWeight="Bold"
                   Margin="0,10,0,8"/>
        <Grid Grid.Row="6" Margin="0,0,0,8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="12"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Column="0" Text="Dossier de sortie :" VerticalAlignment="Center" FontSize="10"/>
            <TextBox x:Name="OutputFolderTextBox" Grid.Column="2" Style="{StaticResource RoundedTextBoxStyle}" FontSize="16"/>
            <Button x:Name="BrowseFolderButton" Grid.Column="3" Content="CHOISIR" Width="90" Click="BrowseFolderButton_Click"/>
        </Grid>
        <CheckBox x:Name="DeleteOldCheckBox" Grid.Row="6" Visibility="Collapsed"/>

        <!-- Bouton G√âN√âRER -->
        <Button x:Name="GenerateButton" Grid.Row="7" Content="G√âN√âRER"
                Height="44" Width="200" FontSize="16" Margin="0,30,0,0"
                HorizontalAlignment="Center" Click="GenerateButton_Click"/>

        <!-- Logs -->
        <Border Grid.Row="9"
                Margin="0,25,0,0"
                Background="#990000"
                CornerRadius="12"
                Padding="8">
            <TextBox x:Name="LogsTextBox"
                    Background="Transparent"
                    Foreground="White"
                    BorderThickness="0"
                    IsReadOnly="True"
                    AcceptsReturn="True"
                    VerticalScrollBarVisibility="Auto"/>
        </Border>
    </Grid>
</Window>
